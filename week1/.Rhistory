require(reshape2)
require(ggplot2)
require(stringr)
require(gridExtra)
df = read.csv("C:\Users\Philipp.Deutsch\Desktop\sales_budget_ta.csv")
df = read.csv("C:\\Users\\Philipp.Deutsch\\Desktop\\sales_budget_ta.csv")
df = df[!is.na(df$Actual_Sales) & !is.na(df$TABudget_Sales) & str_trim(df$LC_Efficiency)!='' & df$Actual_Sales > 0 & df$TABudget_Sales > 0,]
df$proposition_flag = as.factor(df$proposition_flag)
df$Location_Type = as.factor(df$Location_Type)
df$Core_Non_Core= as.factor(df$Core_Non_Core)
df$Division= as.factor(df$Division)
df$Garden_Center_flag= as.factor(df$Garden_Center_flag)
df$Showroom_flag= as.factor(df$Showroom_flag)
df$Size_Quartiles= as.factor(df$Size_Quartiles)
p1 = ggplot() + geom_point(data=df, aes(x=Actual_Sales, y=TABudget_Sales, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=Actual_Sales, y=Actual_Sales))
round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, LC_Efficiency, function(x) mean(abs(x)))),1)
t(round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, LC_Efficiency, function(x) mean(abs(x)))),1))
data.frame(error=(round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, LC_Efficiency, function(x) mean(abs(x)))),1)))
data.frame(error=(round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, proposition_flag, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, LC_Efficiency, function(x) mean(abs(x)))),1)))
data.frame(error=(round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, LC_Efficiency, function(x) mean(abs(x)))),1)))
data.frame(error=round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, proposition_flag, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, Location_Type, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, Core_Non_Core, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, Division, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((TABudget_Sales-Actual_Sales)/Actual_Sales, Garden_Center_flag, function(x) mean(abs(x)))),1))
df$x = df$Actual_Sales
df$y = df$TABudget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
palette <- c( "#FF9933", "#002C54", "#3375B2", "#CCDDEC", "#BFBFBF", "#000000")
ggplot() + geom_point(data=df, aes(x=x, y=y, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=(round(100*with(df, tapply((y-x)/x, LC_Efficiency, function(x) mean(abs(x)))),1)))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Location_Type), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Division), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Division, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Garden_Center_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Garden_Center_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Showroom_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
round(100*with(df, tapply((y-x)/x, Showroom_flag, function(x) mean(abs(x)))),1)
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Size_Quartiles), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
round(100*with(df, tapply((y-x)/x, Size_Quartiles, function(x) mean(abs(x)))),1)
data.frame(error=round(100*with(df, tapply((y-x)/x, Showroom_flag, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((y-x)/x, Size_Quartiles, function(x) mean(abs(x)))),1))
df$y = df$Budget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=(round(100*with(df, tapply((y-x)/x, LC_Efficiency, function(x) mean(abs(x)))),1)))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Location_Type), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Division), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Division, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Garden_Center_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Garden_Center_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Showroom_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Showroom_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Size_Quartiles), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Size_Quartiles, function(x) mean(abs(x)))),1))
df$x = df$Budget_Sales
df$x = df$Actual_Sales
df$y = df$Budget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=(round(100*with(df, tapply((y-x)/x, LC_Efficiency, function(x) mean(abs(x)))),1)))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Location_Type), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
head(df[df$Location_Type='',])
head(df[df$Location_Type=='',])
head(df[str_trim(df$Location_Type)=='',])
uniwue(df$store_id[str_trim(df$Location_Type)=='',])
unique(df$store_id[str_trim(df$Location_Type)=='',])
unique(df$store_id[str_trim(df$Location_Type)==''])
df = df[!is.na(df$Actual_Sales) &
!is.na(df$TABudget_Sales) &
str_trim(df$LC_Efficiency)!=''
& df$Actual_Sales > 0
& df$TABudget_Sales > 0 &
str_trim(df$Location_Type)!='',]
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Location_Type), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
unique(df$store_id[str_trim(df$Core_Non_Core)==''])
df = df[!is.na(df$Actual_Sales) &
!is.na(df$TABudget_Sales) &
str_trim(df$LC_Efficiency)!=''
& df$Actual_Sales > 0
& df$TABudget_Sales > 0 &
str_trim(df$Location_Type)!='' &
str_trim(df$Core_Non_Core)!='',]
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
df = df[!is.na(df$Actual_Sales) &
!is.na(df$TABudget_Sales) &
str_trim(df$LC_Efficiency)!=''
& df$Actual_Sales > 0
& df$TABudget_Sales > 0 &
str_trim(df$Location_Type)!='' &
str_trim(df$Core_Non_Core)!='',]
unique(df$store_id[str_trim(df$Core_Non_Core)==''])
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Garden_Center_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Garden_Center_flag, function(x) mean(abs(x)))),1))
with(df, mean(abs(Actual_Sales-Budget_Sales)/Actual_Sales))
with(df, mean((Actual_Sales-Budget_Sales)/Actual_Sales))
with(df, mean(abs(y-x)/x))
with(df, mean((y-x)/x))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
df$x = df$Budget_Sales
df$y = df$TABudget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
df$x = df$Actual_Sales - df$Budget_Sales
df$y = df$Actual_Sales - df$TABudget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=(round(100*with(df, tapply((y-x)/x, LC_Efficiency, function(x) mean(abs(x)))),1)))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
df$x = abs(df$Actual_Sales - df$Budget_Sales)
df$y = abs(df$Actual_Sales - df$TABudget_Sales)
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Location_Type), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Division), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Garden_Center_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Garden_Center_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Size_Quartiles), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
df$x = df$Actual_Sales
df$y = df$Budget_Sales
df$x = df$Actual_Sales
df$y = df$Budget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Garden_Center_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Garden_Center_flag, function(x) mean(abs(x)))),1))
data.frame(error=(round(100*with(df, tapply((y-x)/x, LC_Efficiency, function(x) mean(abs(x)))),1)))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df[df$store_id==140,], aes(x=x, y=y, col=Size_Quartiles), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
require(reshape2)
require(ggplot2)
require(stringr)
palette <- c( "#FF9933", "#002C54", "#3375B2", "#CCDDEC", "#BFBFBF", "#000000")
df = read.csv("C:\\Users\\Philipp.Deutsch\\Desktop\\sales_budget_ta.csv")
df = df[!is.na(df$Actual_Sales) &
!is.na(df$TABudget_Sales) &
str_trim(df$LC_Efficiency)!=''
& df$Actual_Sales > 0
& df$TABudget_Sales > 0 &
str_trim(df$Location_Type)!='' &
str_trim(df$Core_Non_Core)!='',]
df$proposition_flag = as.factor(df$proposition_flag)
df$Location_Type = as.factor(df$Location_Type)
df$Core_Non_Core= as.factor(df$Core_Non_Core)
df$Division= as.factor(df$Division)
df$Garden_Center_flag= as.factor(df$Garden_Center_flag)
df$Showroom_flag= as.factor(df$Showroom_flag)
df$Size_Quartiles= as.factor(df$Size_Quartiles)
df$x = df$Budget_Sales
df$y = df$TABudget_Sales
ggplot() + geom_point(data=df[df$store_id==140,], aes(x=x, y=y, col=Size_Quartiles), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
ggplot() + geom_point(data=df[df$store_id==140,], aes(x=x, y=y), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
ggplot() + geom_point(data=df[df$store_id==125,], aes(x=x, y=y), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
ggplot() + geom_point(data=df[df$store_id==140,], aes(x=x, y=y), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
with(df[df$store_id==140,], mean(Budget_Sales))
with(df[df$store_id==140,], mean(TABudget_Sales))
with(df[df$store_id==140,], mean(Sales_Actual))
head(df)
names(df)
geom_line(data=df[df$store_id==140,], aes(x=TABudget_Sales/Budget_Sales-1, y=week)) + theme_bw()
ggplot() +
geom_line(data=df[df$store_id==140,], aes(x=TABudget_Sales/Budget_Sales-1, y=week)) + theme_bw()
geom_line(data=df[df$store_id==140,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() +
geom_line(data=df[df$store_id==140,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() +
geom_line(data=df[df$store_id==125,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==16,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==125,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==140,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
df$x = df$Actual_Sales
df$y = df$Budget_Sales
ggplot() + geom_point(data=df[df$store_id==140,], aes(x=x, y=y), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
ggplot() + geom_point(data=df[df$store_id==125,], aes(x=x, y=y), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
ggplot() + geom_line(data=df[df$store_id==140,], aes(y=Actual_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==125,], aes(y=Actual_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==140,], aes(y=Actual_Sales/Budget_Sales-1, x=week)) + theme_bw()
store = 140
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=Actual_Sales/Budget_Sales-1, x=week)) + theme_bw()
head(unique(df$store_id))
store = 18
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
store = 17
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
store = 16
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
store = 15
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
store = 12
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=TABudget_Sales/Budget_Sales-1, x=week)) + theme_bw()
ggplot() + geom_line(data=df[df$store_id==store,], aes(y=Actual_Sales/Budget_Sales-1, x=week)) + theme_bw()
df = read.csv("C:\\Users\\Philipp.Deutsch\\Desktop\\sales_budget_ta.csv")
df = df[!is.na(df$Actual_Sales) &
!is.na(df$TABudget_Sales) &
str_trim(df$LC_Efficiency)!=''
& df$Actual_Sales > 0
& df$TABudget_Sales > 0 &
str_trim(df$Location_Type)!='' &
str_trim(df$Core_Non_Core)!='',]
df$proposition_flag = as.factor(df$proposition_flag)
df$Location_Type = as.factor(df$Location_Type)
df$Core_Non_Core= as.factor(df$Core_Non_Core)
df$Division= as.factor(df$Division)
df$Garden_Center_flag= as.factor(df$Garden_Center_flag)
df$Showroom_flag= as.factor(df$Showroom_flag)
df$Size_Quartiles= as.factor(df$Size_Quartiles)
df$x = df$Actual_Sales
df$y = df$Budget_Sales
ggplot() + geom_point(data=df, aes(x=x, y=y, col=LC_Efficiency), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=(round(100*with(df, tapply((y-x)/x, LC_Efficiency, function(x) mean(abs(x)))),1)))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=proposition_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, proposition_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Location_Type), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Location_Type, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Core_Non_Core), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Core_Non_Core, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Garden_Center_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Garden_Center_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Showroom_flag), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Showroom_flag, function(x) mean(abs(x)))),1))
ggplot() + geom_point(data=df, aes(x=x, y=y, col=Size_Quartiles), size=3, alpha=0.75) + theme_bw() + scale_color_manual(values=palette) + geom_line(data=df, aes(x=x, y=x))
data.frame(error=round(100*with(df, tapply((y-x)/x, Size_Quartiles, function(x) mean(abs(x)))),1))
setwd("~/Analytics/Edge/week1")
mvt = read.csv("mvtWeek1.csv")
head(MVT)
head(mvt)
dim(mvt)
max(mvt$ID)
min(mvt$Beat)
head(mvt)
sum(mvt$Arrest)
table(mvt$LocationDescription)
sum(mvt$LocationDescription=="ALLEY)
sum(mvt$LocationDescription=="ALLEY")
summary(mvt)
summary(mvt$LocationDescription)
data.frame(summary(mvt$LocationDescription))
head(data.frame(summary(mvt$LocationDescription)))
head(data.frame(summary(mvt$LocationDescription)),20)
DateConvert = as.Date(strptime(mvt$Date, "%m/%d/%y %H:%M"))
median(DateConvert)
mvt$Month = months(DateConvert)
mvt$Weekday = weekdays(DateConvert)
mvt$Date = DateConvert
head(mvt)
table(mvt$Month)
table(mvt$Month)
data.frame(table(mvt$Month))
data.frame(table(mvt$Weekday))
head(mvt)
data.frame(table(mvt$Month[mvt$Arrest]))
hist(mvt$Date, breaks=100)
boxplot(Date ~ Arrest, mvt)
head(mvt)
data.frame(prop.table(table(mvt$Arrest[mvt$Year==2001])))
data.frame(prop.table(table(mvt$Arrest[mvt$Year==2007])))
data.frame(prop.table(table(mvt$Arrest[mvt$Year==2012])))
sort(table(mvt$LocationDescription))
head(data.frame(sort(table(mvt$LocationDescription))))
tail(data.frame(sort(table(mvt$LocationDescription))))
tail(data.frame(sort(-table(mvt$LocationDescription))))
tail(data.frame(sort(table(mvt$LocationDescription))))
mvt2 = mvt[mvt$LocationDescription %in%
c("DRIVEWAY - RESIDENTIAL",
"GAS STATION",
"ALLEY",
"PARKING LOT/GARAGE(NON.RESID.)",
"STREET")
,]
dim(mvt2)
Top5 = mvt[mvt$LocationDescription %in%
c("DRIVEWAY - RESIDENTIAL",
"GAS STATION",
"ALLEY",
"PARKING LOT/GARAGE(NON.RESID.)",
"STREET")
,]
Top5$LocationDescription = factor(Top5$LocationDescription)
head(Top5)
out = data.frame(table(Top5$Arrest))
out
out = data.frame(table(Top5$Arrest, Top5$LocationDesctiption))
table(Top5$Arrest, Top5$LocationDesctiption)
table(Top5$Arrest, Top5$LocationDescription)
table(Top5$LocationDescription, Top5$Arrest)
arrestrate= table(Top5$LocationDescription, Top5$Arrest)
arrestrate$rate = with(arrestrate, TRUE / (TRUE + FALSE))
names(arrestrate) = c("yes", "no")
arrestrate$rate = with(arrestrate, yes / (yes + no))
arrestrate
arrestrate= data.frame(table(Top5$LocationDescription, Top5$Arrest))
names(arrestrate) = c("yes", "no")
arrestrate$rate = with(arrestrate, yes / (yes + no))
arrestrate
arrestrate= as.matrix((table(Top5$LocationDescription, Top5$Arrest)))
arrestrate
arrestrate= data.frame(as.matrix((table(Top5$LocationDescription, Top5$Arrest))))
arrestrate
arrestrate= as.matrix((table(Top5$LocationDescription, Top5$Arrest)))
arrestrate
arrestrate= table(Top5$LocationDescription, Top5$Arrest))
arrestrate= table(Top5$LocationDescription, Top5$Arrest)
arrestrate
arrestrate= as.data.frame.matrix(table(Top5$LocationDescription, Top5$Arrest))
arrestrate
names(arrestrate) = c("yes", "no")
arrestrate$rate = with(arrestrate, yes / (yes + no))
arrestrate
table(Top5$LocationDescription)
144969+11595
arrestrate
table(Top5$Weekday)
data.frame(table(Top5$Weekday))
data.frame(table(Top5$Weekday[Top5$LocationDescription=="GAS STATION"]))
data.frame(table(Top5$Weekday[Top5$LocationDescription=="DRIVEWAY - RESIDENTIAL"]))
arrestrate
sum(Top5$Arrest[Top5$LocationDescription=="STREET"])
arrestrate= as.data.frame.matrix(table(Top5$LocationDescription, Top5$Arrest))
arrestrate
names(arrestrate) = c("no", "yes")
arrestrate$rate = with(arrestrate, yes / (yes + no))
arrestrate
IBM = read.csv("IBMStock.csv")
GE = read.csv("GEStock.csv")
ProcterGamble = read.csv("ProcterGambleStock.csv")
CocaCola = read.csv("CocaColaStock.csv")
Boeing = read.csv("BoeingStock.csv")
IBM$Date = as.Date(IBM$Date, "%m/%d/%y")
GE$Date = as.Date(GE$Date, "%m/%d/%y")
CocaCola$Date = as.Date(CocaCola$Date, "%m/%d/%y")
ProcterGamble$Date = as.Date(ProcterGamble$Date, "%m/%d/%y")
Boeing$Date = as.Date(Boeing$Date, "%m/%d/%y")
dim(IBM)
min(GE$Date)
max(Boeing$Date)
mean(IBM$StockPrice)
min(GE$StockPrice)
max(CocaCola$StockPrice)
median(Boeing$StockPrice)
sd(ProcterGamble$StockPrice)
plot(StockPrice ~ Date, data=CocaCola, type="l")
lines(ProcterGamble$Date, ProcterGamble$StockPrice)
plot(StockPrice ~ Date, data=CocaCola, type="l", col="red")
lines(ProcterGamble$Date, ProcterGamble$StockPrice)
plot(StockPrice ~ Date, data=CocaCola, type="l", col="red")
lines(ProcterGamble$Date, ProcterGamble$StockPrice, col="blue")
abline(v=as.Date(c("2000-03-01")), lwd=2)
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
head(IBM)
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210), xlim=c(as.Date("1997-09-01"), as.Date("1997-11-30")))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210), xlim=c(as.Date("1997-08-01"), as.Date("1997-12-30")))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210), xlim=c(as.Date("1997-09-01"), as.Date("1997-11-30")))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210), xlim=c(as.Date("1997-09-01"), as.Date("1997-11-01")))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="black")
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green")
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="blue")
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="Orange")
months(IBM$Date)
tapply(IBM$StockPrice, months(IBM$Date), mean)
tapply(IBM$StockPrice, months(IBM$Date), mean) - mean(IBM$StockPrice)
data.frame(tapply(IBM$StockPrice, months(IBM$Date), mean) - mean(IBM$StockPrice))
data.frame(delta=tapply(IBM$StockPrice, months(IBM$Date), mean) - mean(IBM$StockPrice))
sort(data.frame(delta=tapply(IBM$StockPrice, months(IBM$Date), mean) - mean(IBM$StockPrice)))
data.frame(delta=sort(tapply(IBM$StockPrice, months(IBM$Date), mean) - mean(IBM$StockPrice)))
data.frame(delta=sort(tapply(GE$StockPrice, months(GE$Date), mean) - mean(GE$StockPrice)))
